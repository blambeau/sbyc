#!/usr/bin/env ruby
$LOAD_PATH.unshift(File.expand_path('../../lib', __FILE__))
require 'sbyc'
require 'sbyc/shortspaces'

if ARGV.size == 1
  puts ::SByC::R::evaluate File.read(ARGV[0])
else
  require 'readline'
  stop = false
  while !stop
    str = Readline.readline("elodie# ", true)
    case str 
      when /q(uit?)/
        stop = true
      else
        begin
          ast = ::SByC::CodeTree::parse(str)
          puts ::SByC::R::evaluate({}, ast)
        rescue Exception => ex
          puts ex.message
          puts ex.backtrace.join("\n")
        end
    end
  end
end